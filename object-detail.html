<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Symbol Detail | The Umbrella</title>
    <link rel="stylesheet" href="style.css">
    
</head>
<body class="hero-init">

    <!-- Global Back button placed above the column layout -->
    <div id="global-back-wrap">
        <button id="back-button" type="button" aria-label="Go back">Back</button>
    </div>
    <!-- Hero sentinel: small spacer used to detect when the user scrolls down
         far enough to reveal the page content. Observed by script.js. -->
    <div id="hero-sentinel" aria-hidden="true"></div>
    <main id="object-container" class="split-layout"> 
    <!-- hero-mode removed: place main image + title into the normal page columns -->

    <section id="metadata-controls" class="metadata-column" data-column-name="Left — Metadata">
            <!-- Main image for the object -->
            <div id="object-image-wrapper">
                <img id="object-image" src="" alt="Photo of the protest symbol" loading="eager">
            </div>
                        <!-- Ensure the target image gets a view-transition-name as early as
                                 possible during parsing so the browser can match it to the
                                 clicked thumbnail. The name format mirrors the gallery's
                                 thumbnail naming (object-<id> or object-src-<hash>). -->
                        <script>
    (function(){
        try {
            var q = new URLSearchParams(location.search);
            var id = q.get('id');
            var img = q.get('img');
            var el = document.getElementById('object-image');
            if (!el) return;

            if (id) {
                // Sets the name to match the gallery (e.g., object-123)
                el.style.viewTransitionName = 'object-' + id; // Use .style, not setAttribute
                return;

            } else if (img) {
                // Algorithm matches the hashString function in infinite-gallery.js
                var s = img || '';
                var h = 0; 
                for (var i = 0; i < s.length; i++) { 
                    h = (h * 31 + s.charCodeAt(i)) >>> 0; 
                }
                el.style.viewTransitionName = 'object-src-' + (h).toString(36);
            }
        } catch(e) {
            console.error("View Transition naming failed:", e);
        }
    })();
</script>
            <h1 id="object-title"></h1>

            <div id="static-tags">
                <p><span id="type-tag"></span></p>
                <p><span id="timeframe-tag"></span></p>
            </div>
        </section>

    <section id="content-display" class="content-column" data-column-name="Center — Content">
       
        
            
        <div id="description-block" class="description-block">
                <section id="desc-section" class="subsection">
                    <h2 class="subsection-title"><button class="subsection-toggle" aria-expanded="true">Description</button></h2>
                    <div class="divider" aria-hidden="true"></div>
                    <div class="subsection-body">
                        <!-- moved filter buttons here from the left metadata column -->
                        <div id="filter-buttons-container" style="margin-bottom:14px;"></div>
                        <article id="description-text"></article>
                    </div>
                </section>

                <section id="gallery-section" class="subsection">
                    <h2 class="subsection-title"><button class="subsection-toggle" aria-expanded="true">Gallery</button></h2>
                    <div class="divider" aria-hidden="true"></div>
                    <div class="subsection-body">
                        <!-- Photo gallery placed under the description in the same column -->
                        <div id="photo-gallery" class="photo-gallery" aria-label="Photo gallery for this object">
                            <!-- Thumbnails will be injected here by script.js -->
                        </div>
                    </div>
                </section>

                <section id="eyewitness-section" class="subsection">
                    <h2 class="subsection-title"><button class="subsection-toggle" aria-expanded="true">Accounts</button></h2>
                    <div class="divider" aria-hidden="true"></div>
                    <div class="subsection-body">
                        <div id="eyewitness-contents" class="eyewitness-contents">
                            <!-- Populated from data if available -->
                        </div>
                    </div>
                </section>

                <section id="sources-section" class="subsection">
                    <h2 class="subsection-title"><button class="subsection-toggle" aria-expanded="true">Sources &amp; News</button></h2>
                    <div class="divider" aria-hidden="true"></div>
                    <div class="subsection-body">
                        <div id="sources-contents" class="sources-contents">
                            <!-- Populated from data if available -->
                        </div>
                    </div>
                </section>
            </div>

            <!-- Lightbox modal for gallery images -->
            <div id="lightbox" class="lightbox" aria-hidden="true">
                <div class="lightbox-backdrop" id="lightbox-backdrop"></div>
                <div class="lightbox-content" role="dialog" aria-modal="true" aria-label="Image preview">
                    <button id="lightbox-close" class="lightbox-close" aria-label="Close">✕</button>
                    <button id="lightbox-prev" class="lightbox-nav lightbox-prev" aria-label="Previous image">‹</button>
                    <button id="lightbox-next" class="lightbox-nav lightbox-next" aria-label="Next image">›</button>
                    <div id="lightbox-media" class="lightbox-media" aria-hidden="true"></div>
                    <div id="lightbox-caption" class="lightbox-caption"></div>
                </div>
            </div>
            
            <aside id="context-panel" class="hidden-panel" data-column-name="Right — Context Panel">
                <button id="close-panel-btn">✕ Close Context</button>
                <div id="context-panel-content">
                    </div>
            </aside>

        </section>

    </main>

    <script src="script.js"></script>


</body>
</html>